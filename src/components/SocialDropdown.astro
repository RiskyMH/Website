---
import ExternalIcon from "./ExternalIcon.svg";
import EllipsisIcon from "./EllipsisIcon.svg";
import GitHubIcon from "./GitHubIcon.svg";
import DiscordIcon from "./DiscordIcon.svg";
---
<style>
.relative:hover .dropdown-menu,
.relative:focus-within .dropdown-menu,
label:hover ~ .dropdown-menu,
.hover-bridge:hover ~ .dropdown-menu,
.dropdown-menu:hover {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}
</style>
<script is:inline>
window.addEventListener('click', (e) => {
  const menu = document.getElementById('social-dropdown-menu');
  const checkbox = document.getElementById('social-dropdown-toggle');
  if (!menu || !checkbox) return;
  if (
    checkbox.checked &&
    !menu.contains(e.target) &&
    !document.querySelector('label[for=social-dropdown-toggle]')?.contains(e.target)
  ) {
    checkbox.checked = false;
  }
});
</script>
<div class="relative group-[social-dropdown]">
  <input id="social-dropdown-toggle" type="checkbox" class="peer hidden" tabindex="-1" />
  <label for="social-dropdown-toggle"
    class="cursor-pointer flex items-center justify-center md:w-20 h-9 md:max-w-20 rounded-lg bg-[#4a4a4a] hover:bg-white hover:text-[#1a1a1a] transition border border-transparent focus:border-white select-none z-20 relative"
    tabindex="0"
    aria-haspopup="true"
    aria-expanded="false"
    aria-controls="social-dropdown-menu"
  >
    <span class="sr-only">More links</span>
    <EllipsisIcon class="w-6 h-6" />
  </label>
  <!-- Hover bridge: covers the visual gap -->
  <div 
    class="hover-bridge absolute z-10 left-0 right-0 h-[15px] md:top-[35px] md:bottom-auto top-auto bottom-[35px]" style="pointer-events:auto" 
    tabindex="-1" 
    aria-hidden="true"
  ></div>
  <div id="social-dropdown-menu" class="dropdown-menu absolute right-0 md:top-12 md:bottom-auto top-auto bottom-12 mt-0 z-30 min-w-full max-h-[90vh] overflow-y-auto rounded-xl bg-[#242424] shadow-lg ring-1 ring-white/10
    opacity-0 invisible pointer-events-none
    peer-checked:opacity-100 peer-checked:visible peer-checked:pointer-events-auto
      focus-within:opacity-100 focus-within:visible focus-within:pointer-events-auto
      hover:opacity-100 hover:visible hover:pointer-events-auto
      transition-all duration-200"

  >
      <ul class="py-2 text-sm font-medium text-white flex flex-col min-w-[12rem]">
        <slot />
      </ul>
  </div>
</div>
